<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loja Tech â€” Carrinho</title>
  <meta name="description" content="Loja de eletrÃ´nicos e informÃ¡tica com carrinho, checkout, agendamentos e painel admin (demo em HTML/JS com localStorage), conectada ao login."/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="StyleCarrinho.css">
</head>
<body>
  <header>
    <div class="container nav">
  <a href="Index.html" class="brand" aria-label="PÃ¡gina inicial">
    <span class="brand-logo" aria-hidden="true">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 3l8 4.5v9L12 21l-8-4.5v-9L12 3z" stroke="white" stroke-width="1.5" />
        <path d="M7 8l5 2.8 5-2.8" stroke="white" stroke-opacity=".6"/>
      </svg>
    </span>

    <span>Loja Tech</span>
  </a>
    <a href="carrinho.html" class="btn-carrinho">
      Carrinho (<span id="cart-count">0</span>)
    </a>
    </div>
  </header>

  <main>
    <div id="cart-container"></div>
    <div class="total-container">
 
      <button id="btn-limpar">ðŸ§¹ Esvaziar</button>
      <button id="btn-finalizar" onclick="window.location.href='pagamento/pagamento.html'">ðŸ’³ Finalizar Compra</button>
      <button id="btn-voltar" onclick="window.location.href='Index.html'">ðŸ‘œ Continuar comprando</button>
    </div>
  </main>



    <div id="cart-preview" style="display:none;margin-top:12px"></div>

  <script src="carrinho.js"></script>
  <script>
    // mostra um preview amigÃ¡vel do conteÃºdo salvo em localStorage.carrinho
    (function(){
      try{
        const raw = localStorage.getItem('carrinho');
        const el = document.getElementById('cart-preview');
        if(!el) return;
        if(!raw) { el.style.display = 'none'; return; }
        const items = JSON.parse(raw || '[]');
        if(!Array.isArray(items) || items.length===0){ el.style.display = 'none'; return; }
        // monta um card compacto para cada item
        el.style.display = 'block';
        el.innerHTML = '<h4 style="margin:0 0 8px;color:#111">Preview do carrinho salvo</h4>';
        const list = document.createElement('div');
        list.style.display = 'flex';
        list.style.flexDirection = 'column';
        list.style.gap = '8px';
        // calcula total usando a API normalizada se disponÃ­vel, senÃ£o somar os valores brutos
        try{
          let totalCalc = 0;
          if (typeof getCarrinho === 'function'){
            const shared = getCarrinho();
            totalCalc = (Array.isArray(shared) ? shared : []).reduce((s,i)=> s + (Number(i.preco||i.price||0) * Number(i.qtd||i.qty||1)), 0);
          } else {
            totalCalc = items.reduce((s,it)=> s + (Number(it.preco||it.price||0) * Number(it.qtd||it.qty||1)), 0);
          }
          const totalNode = document.createElement('div');
          totalNode.style.margin = '8px 0 0';
          totalNode.style.fontWeight = '700';
          totalNode.style.color = '#111';
          totalNode.textContent = 'Total calculado (preview): ' + (typeof formatCurrency === 'function' ? formatCurrency(totalCalc) : ('R$ ' + totalCalc.toFixed(2)));
          el.appendChild(totalNode);
        }catch(e){ console.error('erro ao calcular total no preview', e); }
        items.forEach(it=>{
          const row = document.createElement('div');
          row.style.display = 'flex';
          row.style.alignItems = 'center';
          row.style.gap = '12px';
          row.style.background = '#fff';
          row.style.padding = '8px';
          row.style.borderRadius = '8px';
          // imagem
          const thumb = document.createElement('div');
          thumb.style.width = '48px';
          thumb.style.height = '48px';
          thumb.style.flex = '0 0 48px';
          thumb.style.borderRadius = '6px';
          thumb.style.overflow = 'hidden';
          thumb.style.background = '#f3f3f3';
          if(it.img){ const im = document.createElement('img'); im.src = it.img; im.alt = it.nome || it.title || it.id; im.style.width='100%'; im.style.height='100%'; im.style.objectFit='cover'; thumb.appendChild(im); }
          else { thumb.textContent = (it.nome||it.title||it.id||'').slice(0,1).toUpperCase(); thumb.style.display='grid'; thumb.style.placeItems='center'; thumb.style.color='#666'; }
          const info = document.createElement('div');
          info.style.flex = '1';
          info.innerHTML = `<div style="font-weight:700;color:#111">${it.nome || it.title || it.id}</div><div style="color:#666;font-size:13px">${formatCurrency(it.preco||it.price||0)} â€” qtde ${Number(it.qtd||it.qty||1)}</div>`;
          row.appendChild(thumb);
          row.appendChild(info);
          list.appendChild(row);
        });
        el.appendChild(list);
      }catch(e){ console.error('erro ao montar cart-preview', e); }
    })();
  </script>

  <footer>
  <div class="container">
    <div class="grid">
      <div class="col-6">
        <strong>Loja Tech</strong>
        <div class="note">CNPJ 00.000.000/0001-00 â€¢ Rua Exemplo, 123 â€” Centro</div>
        <div class="note">Atendimento: segâ€“sex 09:00â€“18:00, sÃ¡b 09:00â€“13:00</div>
      </div>
      <div class="col-6" style="text-align:right">
        <div class="note">Â© <span id="ano"></span> Loja Tech â€” Todos os direitos reservados</div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
